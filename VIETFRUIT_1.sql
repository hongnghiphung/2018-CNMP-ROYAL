CREATE DATABASE QL_VIETFRUIT_1
ON
(NAME='VIETFRUIT_1_DATA',FILENAME='E:\DO_AN\VIETFRUIT_1.MDF')
LOG ON
(NAME='VIETFRUIT_1_LOG',FILENAME='E:\DO_AN\VIETFRUIT_1.LDF')
-----------Lưu đường dẫn--------------------------------
USE QL_VIETFRUIT_1
-----------Chạy với tên VIETFRUIT-----------------------
CREATE TABLE CHUC_NANG
(
		MA_CHUC_NANG CHAR(5) NOT NULL PRIMARY KEY,
		TEN_CHUC_NANG NVARCHAR(10) NOT NULL,
)
-----------Tạo bảng chức năng----------------------------
CREATE TABLE NHAN_VIEN
(
	MA_NHAN_VIEN	CHAR(5) NOT NULL PRIMARY KEY,
	TEN_NHAN_VIEN	NVARCHAR(50) NOT NULL,
	GIOI_TINH	NVARCHAR(5) NOT NULL,
	NGAY_SINH	DATETIME NOT NULL,
	TEN_BO_PHAN NVARCHAR(50) NOT NULL,
	SO_DIEN_THOAI		CHAR(15),
	SCMND   CHAR(15),
	EMAIL   VARCHAR(50),
	DIA_CHI	NVARCHAR(50),
	LUONG_CO_BAN FLOAT,
	ANH		IMAGE,
	
)
-----------Tạo bảng nhân viên--------------------------------
CREATE TABLE GIO_LAM
(
	MA_NHAN_VIEN CHAR(5) NOT NULL,
	MA_GiO_LAM CHAR (20) NOT NULL ,
	NGAY_LAM datetime,
	GIO_LAM FLOAT,
	PRIMARY KEY(MA_NHAN_VIEN,MA_GIO_LAM),
	FOREIGN KEY(MA_NHAN_VIEN) REFERENCES NHAN_VIEN(MA_NHAN_VIEN)
)
----------------Tạo bảng giờ làm--------------------------------
CREATE TABLE TAI_KHOAN
(
	MA_NHAN_VIEN CHAR(5) NOT NULL,
	TEN_TAI_KHOAN CHAR(20) NOT NULL UNIQUE,
	MAT_KHAU CHAR(20) NOT NULL,
	PRIMARY KEY(TEN_TAI_KHOAN),
	FOREIGN KEY (MA_NHAN_VIEN) REFERENCES NHAN_VIEN(MA_NHAN_VIEN)
)
-------------Tạo bảng tài khoản----------------------------
CREATE TABLE TRANG_THAI
(
	TEN_TAI_KHOAN CHAR(20),
	MA_CHUC_NANG CHAR(5),
	TRANG_THAI BIT,
	PRIMARY KEY(TEN_TAI_KHOAN,MA_CHUC_NANG),
	FOREIGN KEY (TEN_TAI_KHOAN) REFERENCES TAI_KHOAN(TEN_TAI_KHOAN),
	FOREIGN KEY (MA_CHUC_NANG) REFERENCES CHUC_NANG(MA_CHUC_NANG)
)
---------------Tạo bảng trạng thái----------------------------------

CREATE TABLE KHO_SAN_PHAM
(
	MA_SAN_PHAM  CHAR(5) NOT NULL PRIMARY KEY,
	TEN_SAN_PHAM NVARCHAR(50) NOT NULL, 
	KHOI_LUONG_NHAP FLOAT NOT NULL,
	GIA_NHAP_VAO FLOAT NOT NULL,
	GIA_BAN_RA FLOAT NOT NULL,
	NGAY_DONG_GOI DATETIME NOT NULL,
	NGAY_HET_HAN DATETIME NOT NULL,
	NHA_CUNG_CAP NVARCHAR(50),
	NOI_XUAT_XU NVARCHAR(50),
	ANH		IMAGE,
)
-----------Tạo bảng kho sản phẩm---------------------------------
CREATE TABLE KHACH_HANG
(
	MA_KHACH_HANG CHAR(5) NOT NULL PRIMARY KEY,
	HO_TEN NVARCHAR(50) NOT NULL,
	GIOI_TINH	NVARCHAR(5) NOT NULL,
	NGAY_SINH	DATETIME NOT NULL, 
	SO_DIEN_THOAI	CHAR(15),
	SCMND   CHAR(15),			
	DIEM_TICH_LUY INT NOT NULL,	
	EMAIL VARCHAR(50),
	DIA_CHI	NVARCHAR(50),
	ANH		IMAGE,
)
-----------Tạo bảng khách hàng-------------------------------------
CREATE TABLE HOA_DON
(
	MA_HOA_DON CHAR(6) NOT NULL PRIMARY KEY,
	MA_NHAN_VIEN CHAR(5) NOT NULL,
	MA_KHACH_HANG CHAR(5),
	NGAY_TAO DATETIME NOT NULL,
	TONG_TIEN FLOAT NOT NULL,
	FOREIGN KEY (MA_NHAN_VIEN) REFERENCES NHAN_VIEN(MA_NHAN_VIEN),
	FOREIGN KEY (MA_KHACH_HANG) REFERENCES KHACH_HANG(MA_KHACH_HANG)

)
-----------Tạo bảng hóa đơn--------------------------------------
CREATE TABLE CHI_TIET_HOA_DON
(
	MA_HOA_DON CHAR(6) NOT NULL,
	MA_SAN_PHAM CHAR(5) NOT NULL,
	KHOI_LUONG FLOAT NOT NULL,
	DON_GIA FLOAT NOT NULL,
	THANH_TIEN FLOAT NOT NULL,
	PRIMARY KEY ( MA_HOA_DON, MA_SAN_PHAM),
	FOREIGN KEY (MA_HOA_DON) REFERENCES HOA_DON(MA_HOA_DON),
	FOREIGN KEY (MA_SAN_PHAM) REFERENCES KHO_SAN_PHAM(MA_SAN_PHAM)
)
--------------Tạo bảng chi tiết hóa đơn-----------------------------
SET DATEFORMAT DMY
--------------Format ngày tháng năm----------------------------------

INSERT INTO KHO_SAN_PHAM VALUES('SP000',N'VIETFRUIT',00,00,00,'1/1/2018','1/1/2018','','','')--Tạo khởi đầu.

INSERT INTO KHO_SAN_PHAM VALUES('SP001',N'Dứa Bến Tre',50,20000,25000,'22/12/2017','22/2/2018',N'HTX Bầu Trời',N'Bến Tre','')
INSERT INTO KHO_SAN_PHAM VALUES('SP002',N'Măng Cụt',50,35000,40000,'22/12/2017','22/2/2018',N'HTX Vườn Xanh',N'Đồng Nai','')
INSERT INTO KHO_SAN_PHAM VALUES('SP003',N'Mít Thái',50,5000,10000,'22/12/2017','22/2/2018',N'HTX Vườn Xanh',N'Đồng Nai','')
INSERT INTO KHO_SAN_PHAM VALUES('SP004',N'Thanh Long',50,5000,10000,'22/12/2017','22/2/2018',N'HTX Vườn Xanh',N'Đồng Nai','')
INSERT INTO KHO_SAN_PHAM VALUES('SP005',N'Ổi',50,5000,10000,'22/12/2017','22/2/2018',N'HTX Vườn Xanh',N'Đồng Nai','')
INSERT INTO KHO_SAN_PHAM VALUES('SP006',N'Xoài',50,15000,20000,'22/12/2017','22/2/2018',N'Hiệp hội Du lịch',N'Sơn La','')
INSERT INTO KHO_SAN_PHAM VALUES('SP007',N'Đào',50,20000,25000,'22/12/2017','22/2/2018',N'Hiệp hội Du lịch',N'Sơn La','')
INSERT INTO KHO_SAN_PHAM VALUES('SP008',N'Lê',50,15000,20000,'22/12/2017','22/2/2018',N'Hiệp hội Du lịch',N'Sơn La','')
INSERT INTO KHO_SAN_PHAM VALUES('SP009',N'Táo New Zealand',50,40000,45000,'22/12/2017','22/2/2018',N'CTNK trái cây Bình Thuận',N'TPHCM','')
INSERT INTO KHO_SAN_PHAM VALUES('SP010',N'Nho Úc',50,80000,85000,'22/12/2017','22/2/2018',N'CTNK trái cây Bình Thuận',N'TPHCM','')
INSERT INTO KHO_SAN_PHAM VALUES('SP011',N'Nho Mỹ',50,85000,90000,'22/12/2017','22/2/2018',N'CTNK trái cây Bình Thuận',N'TPHCM','')
INSERT INTO KHO_SAN_PHAM VALUES('SP012',N'Chôm Chôm Thường',50,20000,25000,'22/12/2017','22/2/2018',N'CTNK trái cây Bình Thuận',N'TPHCM','')
INSERT INTO KHO_SAN_PHAM VALUES('SP013',N'Xoài Đài Loan',50,30000,35000,'22/12/2017','22/2/2018',N'CTNK trái cây Bình Thuận',N'TPHCM','')
INSERT INTO KHO_SAN_PHAM VALUES('SP014',N'Quýt Đường',50,35000,40000,'22/12/2017','22/2/2018',N'CTNK trái cây Bình Thuận',N'TPHCM','')
INSERT INTO KHO_SAN_PHAM VALUES('SP015',N'Cam Sành',50,20000,25000,'22/12/2017','22/2/2018',N'CTNK trái cây Bình Thuận',N'TPHCM','')
INSERT INTO KHO_SAN_PHAM VALUES('SP016',N'Bưởi Năm Roi',50,30000,35000,'22/12/2017','22/2/2018',N'CTNK trái cây Bình Thuận',N'TPHCM','')
INSERT INTO KHO_SAN_PHAM VALUES('SP017',N'Thanh Long Bình Thuận',50,20000,25000,'22/12/2017','22/2/2018',N'CTNK trái cây Bình Thuận',N'TPHCM','')
INSERT INTO KHO_SAN_PHAM VALUES('SP018',N'Dưa Hấu Đỏ',50,10000,15000,'22/12/2017','22/2/2018',N'CTNK trái cây Bình Thuận',N'TPHCM','')
INSERT INTO KHO_SAN_PHAM VALUES('SP019',N'Xoài Cát Chu',50,40000,45000,'22/12/2017','22/2/2018',N'CTNK trái cây Bình Thuận',N'TPHCM','')
INSERT INTO KHO_SAN_PHAM VALUES('SP020',N'Đu Đủ',50,15000,20000,'22/12/2017','22/2/2018',N'CTNK trái cây Bình Thuận',N'TPHCM','')
INSERT INTO KHO_SAN_PHAM VALUES('SP021',N'Chôm Chôm Nhãn',50,30000,35000,'22/12/2017','22/2/2018',N'CTNK trái cây Bình Thuận',N'TPHCM','')
INSERT INTO KHO_SAN_PHAM VALUES('SP022',N'Mãng Cầu Tròn',50,35000,40000,'22/12/2017','22/2/2018',N'CTNK trái cây Bình Thuận',N'TPHCM','')
INSERT INTO KHO_SAN_PHAM VALUES('SP023',N'Nhãn Huế',50,25000,30000,'22/12/2017','22/2/2018',N'CTNK trái cây Sophia',N'TPHCM','')
INSERT INTO KHO_SAN_PHAM VALUES('SP024',N'Sầu Riêng Khổ Qua',50,70000,75000,'22/12/2017','22/2/2018',N'CTNK trái cây Sophia',N'TPHCM','')
INSERT INTO KHO_SAN_PHAM VALUES('SP025',N'Sầu Riêng Ri 6',50,90000,95000,'22/12/2017','22/2/2018',N'CTNK trái cây Sophia',N'TPHCM','')
INSERT INTO KHO_SAN_PHAM VALUES('SP026',N'Nho Xanh Phan Rang',50,30000,35000,'22/12/2017','22/2/2018',N'CTNK trái cây Sophia',N'TPHCM','')
INSERT INTO KHO_SAN_PHAM VALUES('SP027',N'Nhãn Xuồng',50,90000,95000,'22/12/2017','22/2/2018',N'CTNK trái cây Sophia',N'TPHCM','')
INSERT INTO KHO_SAN_PHAM VALUES('SP028',N'Thanh Long Long An',50,35000,40000,'22/12/2017','22/2/2018',N'CTNK trái cây Sophia',N'TPHCM','')
INSERT INTO KHO_SAN_PHAM VALUES('SP029',N'Chôm Chôm Thái',50,30000,35000,'22/12/2017','22/2/2018',N'CTNK trái cây Sophia',N'TPHCM','')
INSERT INTO KHO_SAN_PHAM VALUES('SP030',N'Bưởi Da Xanh',50,40000,45000,'22/12/2017','22/2/2018',N'CTNK trái cây Sophia',N'TPHCM','')

----------------------- Thêm sản phẩm vào kho-------------------------------------------------------------------------------------


INSERT INTO NHAN_VIEN VALUES('NV000',N'VIETFFRUIT','00','1/1/2018','00',00,00,'','',00,'') --Tạo khởi đầu.

INSERT INTO NHAN_VIEN VALUES('NV001',N'Lương Mộng Như',N'Nữ','16/04/1997',N'Thu ngân',0924875485,159357456,N'luongmongnhu@gmail.com',N'TPHCM',18000,'')
INSERT INTO NHAN_VIEN VALUES('NV002',N'Nguyễn Ngọc Đài Trang',N'Nữ','16/05/1997',N'Thu ngân',0924125489,102458741,N'nguyenngocdaitrang@gmail.com',N'TPHCM',18000,'')
INSERT INTO NHAN_VIEN VALUES('NV003',N'Nguyễn Gia Linh',N'Nữ','16/06/1997',N'Thu ngân',0924876521,451554875,N'nguyengialinh@gmail.com',N'TPHCM',18000,'')
INSERT INTO NHAN_VIEN VALUES('NV004',N'Đoan Ngọc Thảo',N'Nữ','16/07/1997',N'Quản lý kho',0924548414,789545154,N'doanngocthao@gmail.com',N'TPHCM',20000,'')
INSERT INTO NHAN_VIEN VALUES('NV005',N'Kim Thị Mỹ Hoa',N'Nữ','16/08/1997',N'Quản lý kho',0924159354,155423698,N'kimthimyhoa@gmail.com',N'TPHCM',20000,'')

-------------------------Thêm danh sách nhân viên---------------------------------------------------------------------------------------

INSERT INTO KHACH_HANG VALUES('KH000',N'VIETFRUIT','','1/1/2018',00,00,00,'','','')-- Tạo khởi đầu.

INSERT INTO KHACH_HANG VALUES('KH001',N'Lê Chí Dũng',N'Nam','16/04/1997',0924587915,123456789,10,N'lechidung@gmail.com',N'TPHCM','')
INSERT INTO KHACH_HANG VALUES('KH002',N'Nguyễn Thị Mỹ Dung',N'Nữ','16/05/1997',0924458745,213456789,20,N'nguyenthimydung@gmail.com',N'TPHCM','')
INSERT INTO KHACH_HANG VALUES('KH003',N'Trần Anh Duy',N'Nam','16/06/1997',0924458715,312456789,30,N'trananhduy@gmail.com',N'TPHCM','')
INSERT INTO KHACH_HANG VALUES('KH004',N'Nguyễn Ngọc Bảo Cương',N'Nam','16/04/1997',0924789465,412356789,40,N'nguyengocbaocuong@gmail.com',N'TPHCM','')
INSERT INTO KHACH_HANG VALUES('KH005',N'Nguyễn Cát Tiên',N'Nam','16/08/1997',0924147258,512346789,50,N'nguyencattien@gmail.com',N'TPHCM','')
INSERT INTO KHACH_HANG VALUES('KH006',N'Nguyễn Quang Học',N'Nam','16/09/1997',0924258369,612345789,60,N'nguyenquanghoc@gmail.com',N'TPHCM','')
INSERT INTO KHACH_HANG VALUES('KH007',N'Diệc Hồng Thạnh',N'Nam','16/10/1997',0924963852,785426589,70,N'diechongthanh@gmail.com',N'TPHCM','')
INSERT INTO KHACH_HANG VALUES('KH008',N'Khuất Nguyễn Phi Long',N'Nam','16/11/1997',0924123456,812345679,80,N'khuatnguyenphilong@gmail.com',N'TPHCM','')
INSERT INTO KHACH_HANG VALUES('KH009',N'Đỗ Chí Cường',N'Nam','16/12/1997',0924456987,912345678,90,N'dochicuong@gmail.com',N'TPHCM','')
INSERT INTO KHACH_HANG VALUES('KH010',N'Lê Mai Quyền',N'Nam','16/01/1997',0924458749,987654321,100,N'lemaiquyen@gmail.com',N'TPHCM','')
INSERT INTO KHACH_HANG VALUES('KH011',N'Phương Thái Sơn',N'Nam','16/02/1997',0924784126,897654321,110,N'phuongthaison@gmail.com',N'TPHCM','')
INSERT INTO KHACH_HANG VALUES('KH012',N'Trần Hiếu Thắng',N'Nam','16/03/1997',0924649852,798654321,120,N'tranhieuthang@gmail.com',N'TPHCM','')
INSERT INTO KHACH_HANG VALUES('KH013',N'Nguyễn Phi Việt',N'Nam','16/04/1997',0924548712,698754321,130,N'nguyenphiviet@gmail.com',N'TPHCM','')
INSERT INTO KHACH_HANG VALUES('KH014',N'Hoa Anh Đào',N'Nam','16/05/1997',0924481354,598764321,140,N'hoanhdao@gmail.com',N'TPHCM','')
INSERT INTO KHACH_HANG VALUES('KH015',N'Tiêu Viêm',N'Nam','16/06/1997',0924487415,498765321,150,N'tieuviem@gmail.com',N'TPHCM','')
INSERT INTO KHACH_HANG VALUES('KH016',N'Lâm Động',N'Nam','16/07/1997',0924948424,398765421,160,N'lamdong@gmail.com',N'TPHCM','')
INSERT INTO KHACH_HANG VALUES('KH017',N'Mục Trần',N'Nam','16/08/1997',0924487453,298765431,170,N'muctran@gmail.com',N'TPHCM','')
INSERT INTO KHACH_HANG VALUES('KH018',N'Cỗ Phi Dương',N'Nam','16/09/1997',0924487454,198765432,180,N'cophiduong@gmail.com',N'TPHCM','')
INSERT INTO KHACH_HANG VALUES('KH019',N'Lý Vân Tiêu',N'Nam','16/10/1997',0924487715,147258369,190,N'lyvantieu@gmail.com',N'TPHCM','')
INSERT INTO KHACH_HANG VALUES('KH020',N'Lạc Quan Thường',N'Nữ','16/11/1997',0924987184,741852963,200,N'lacquanthuong@gmail.com',N'TPHCM','')
INSERT INTO KHACH_HANG VALUES('KH021',N'Đinh Linh Nhi',N'Nữ','16/12/1997',0924875187,258147369,210,N'dinhlinhnhi@gmail.com',N'TPHCM','')
INSERT INTO KHACH_HANG VALUES('KH022',N'Thải Hồng',N'Nữ','16/01/1997',0924978445,852741963,220,N'thaihong@gmail.com',N'TPHCM','')
INSERT INTO KHACH_HANG VALUES('KH023',N'Đoan Mộc Thương',N'Nữ','16/02/1997',0924364881,369258147,230,N'doanmocthuong@gmail.com',N'TPHCM','')
INSERT INTO KHACH_HANG VALUES('KH024',N'Đóa Nhi',N'Nữ','16/03/1997',0924978454,963852741,240,N'doanhi@gmail.com',N'TPHCM','')
INSERT INTO KHACH_HANG VALUES('KH025',N'Thi Lễ Vương',N'Nam','16/04/1997',0924487431,137948625,250,N'thilevuong@gmail.com',N'TPHCM','')
INSERT INTO KHACH_HANG VALUES('KH026',N'Mạc Quan Tiếu',N'Nam','16/05/1997',0924497542,684259713,260,N'macquantieu@gmail.com',N'TPHCM','')
INSERT INTO KHACH_HANG VALUES('KH027',N'Mạc Tiểu Xuyên',N'Nam','16/06/1997',0924984218,842657913,270,N'mactieuxuyen@gmail.com',N'TPHCM','')
INSERT INTO KHACH_HANG VALUES('KH028',N'Ninh Thiên Thành',N'Nam','16/07/1997',0924124879,268457913,280,N'ninhthienthanh@gmail.com',N'TPHCM','')
INSERT INTO KHACH_HANG VALUES('KH029',N'Lệ Băng',N'Nữ','16/08/1997',0924875154,794862513,290,N'lebang@gmail.com',N'TPHCM','')
INSERT INTO KHACH_HANG VALUES('KH030',N'Đoan Mộc Hoa',N'Nữ','16/09/1997',0924487721,934862715,300,N'doanmochoa@gmail.com',N'TPHCM','')

-----------------------------------------Tạo danh danh sách khách hàng-------------------------------------------------------------------

INSERT INTO HOA_DON VALUES('HD0000','NV000','KH000','1/1/2018',00)--Tạo khởi đầu

---------------------------Tạo khởi đầu hóa đơn----------------------------------------------------------------------------------

INSERT INTO CHUC_NANG VALUES('CN01',N'Nhân viên')
INSERT INTO CHUC_NANG VALUES('CN02',N'QL kho')
INSERT INTO CHUC_NANG VALUES('CN03',N'Thu ngân')
INSERT INTO CHUC_NANG VALUES('CN04',N'Chủ QL')
INSERT INTO CHUC_NANG VALUES('CN05',N'Thống kê')

--------------------------Tạo danh sách chức năng-----------------------

INSERT INTO TAI_KHOAN VALUES('NV000','Admin','Admin')

--------------------------Tạo tài khoản khởi đầu-------------------------

INSERT INTO TRANG_THAI VALUES('Admin','CN01',1)
INSERT INTO TRANG_THAI VALUES('Admin','CN02',1)
INSERT INTO TRANG_THAI VALUES('Admin','CN03',1)
INSERT INTO TRANG_THAI VALUES('Admin','CN04',1)
INSERT INTO TRANG_THAI VALUES('Admin','CN05',1)



-----------------------Tạo trạng thái ban đầu------------------------------


------------------------TEST CÂU LỆNH SQL------------------------------------

SELECT CN.TEN_CHUC_NANG,TT.TRANG_THAI FROM  CHUC_NANG CN, TRANG_THAI TT WHERE TT.TEN_TAI_KHOAN='Admin'  AND TT.MA_CHUC_NANG=CN.MA_CHUC_NANG
SELECT TEN_TAI_KHOAN FROM TAI_KHOAN WHERE TEN_TAI_KHOAN='aDMIN'
SELECT TK.MA_NHAN_VIEN, TK.TEN_TAI_KHOAN, NV.TEN_NHAN_VIEN, NV.GIOI_TINH,NV.NGAY_SINH,NV.TEN_BO_PHAN,NV.SO_DIEN_THOAI,NV.SCMND,NV.DIA_CHI, TK.MAT_KHAU
FROM  NHAN_VIEN NV, TAI_KHOAN TK
WHERE NV.MA_NHAN_VIEN=TK.MA_NHAN_VIEN AND NV.MA_NHAN_VIEN !='NV000'

SELECT CN.TEN_CHUC_NANG, TT.TRANG_THAI
FROM CHUC_NANG CN, TRANG_THAI TT
WHERE TT.TEN_TAI_KHOAN='Admin' AND CN.MA_CHUC_NANG=TT.MA_CHUC_NANG 

SELECT TRANG_THAI
FROM TRANG_THAI
WHERE TEN_TAI_KHOAN='Admin'
SELECT CN.MA_CHUC_NANG, CN.TEN_CHUC_NANG, TT.TRANG_THAI FROM CHUC_NANG CN, TRANG_THAI TT WHERE TT.TEN_TAI_KHOAN='admin' AND CN.MA_CHUC_NANG=TT.MA_CHUC_NANG

SELECT  MA_CHUC_NANG FROM CHUC_NANG WHERE TEN_CHUC_NANG='Nhân viên' 
UPDATE TRANG_THAI SET TRANG_THAI='1' WHERE TEN_TAI_KHOAN='Hoc' AND MA_CHUC_NANG='CN01'
SELECT  MA_CHUC_NANG FROM CHUC_NANG WHERE TEN_CHUC_NANG='Nhân Viên'

SELECT TK.MA_NHAN_VIEN , NV.TEN_NHAN_VIEN 
FROM TAI_KHOAN TK, NHAN_VIEN NV
WHERE TK.TEN_TAI_KHOAN='ADMIN' AND TK.MA_NHAN_VIEN=NV.MA_NHAN_VIEN

SELECT TK.MA_NHAN_VIEN, TK.TEN_TAI_KHOAN, NV.TEN_NHAN_VIEN, NV.GIOI_TINH,NV.NGAY_SINH,NV.TEN_BO_PHAN,NV.SO_DIEN_THOAI,NV.DIA_CHI, TK.MAT_KHAU FROM  NHAN_VIEN NV, TAI_KHOAN TK WHERE NV.MA_NHAN_VIEN=TK.MA_NHAN_VIEN AND NV.MA_NHAN_VIEN !='NV000' AND NV.TEN_NHAN_VIEN LIKE N'%Như%'
SELECT KHOI_LUONG_NHAP FROM KHO_SAN_PHAM WHERE MA_SAN_PHAM='SP007'
SElECT NGAY_LAM FROM GIO_LAM WHERE MA_NHAN_VIEN ='NV001'
SELECT TOP 1 LEFT (MA_GIO_LAM,2) FROM GIO_LAM WHERE MA_NHAN_VIEN='NV001' ORDER BY MA_GIO_LAM DESC
SELECT  TOP 1 MA_GIO_LAM   FROM GIO_LAM WHERE MA_NHAN_VIEN ='NV001' AND SUBSTRING(MA_GIO_LAM,4,8)='15012018' ORDER BY MA_GIO_LAM DESC
SELECT KH.TEN_SAN_PHAM , CT.KHOI_LUONG, KH.GIA_BAN_RA, CT.THANH_TIEN FROM SAN_PHAM KH, CHI_TIET_HOA_DON CT WHERE CT.MA_HOA_DON ='HD002' AND CT.MA_SAN_PHAM=KH.MA_SAN_PHAM

CREATE VIEW Report1 AS
SELECT KH.TEN_SAN_PHAM , CT.KHOI_LUONG, KH.GIA_BAN_RA, CT.THANH_TIEN 
FROM SAN_PHAM KH, CHI_TIET_HOA_DON CT
WHERE CT.MA_HOA_DON ='HD002' AND CT.MA_SAN_PHAM=KH.MA_SAN_PHAM

SELECT * FROM Report1
SELECT MA_KHACH_HANG, HO_TEN, GIOI_TINH ,NGAY_SINH, SO_DIEN_THOAI, SCMND, DIEM_TICH_LUY, EMAIL, DIA_CHI FROM KHACH_HANG WHERE MA_KHACH_HANG !='KH000' AND DIEM_TICH_LUY >=200
